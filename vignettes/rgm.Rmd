---
title: "An Introduction to rgm"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rgm}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,fig.width=6, fig.height=4
)
```

This vignette is designed to guide users through the process of simulating data and then running an experiment with the RGM package. We'll start by demonstrating how to simulate data, which is a crucial preliminary step. Following this, we'll showcase how to run the estimation process on the simulated data. The focus will be on interpreting various plots generated from the experiment, providing insights into the performance and accuracy of the RGM package.

# Simulating Data

The first step in our analysis is to simulate data, which forms the basis for our subsequent experiment. The RGM package offers functionalities for simulating complex network data, which we will utilize here.

The initial step involves simulating network data using the RGM package. This process sets the stage for our experiment by generating data that mimics real-world complex network structures.


```{r simulation, eval=FALSE}
# Running the simulation with specific parameters
a <- sim.rgm(p=87, B=13, n=346, mcmc_iter = 100, seed=1234)
```


Once we have our simulated data, the next phase is to apply the RGM model to this data. This step involves estimating the network structure and relationships from the data we generated.


```{r run-experiment, eval=FALSE}

# Fitting the model
res <- rgm(a$data, X=a$X, iter=10000)

```



This section provides an in-depth analysis of the simulation results using various plots. We will interpret the plots to understand the model's behavior and accuracy.

\begin{equation}
\label{eq:latentprobit}
P({G_{j_1,j_2}}^{(k)}=1~|~G_{j_1,j_2}^{(-k)}, \Theta, w)= 
 \Phi\Big(\alpha_k+{w_{j_1,j_2}}^t    \beta+\mathbf{c}_k^t\sum_{k' \ne k}\mathbf{c}_{k'}1_{\{{G_{j_1,j_2}}^{(k')}=1\}}\Big),
\end{equation}



## Plotting Sample Theta

```{r load, echo=FALSE}
setwd("~/Library/CloudStorage/Dropbox/MultipleBDgraph/package_cpp/HGrM/HGrM/vignettes")
load("SimRes_p87.RData")
res = smaller_res
```



```{r plot-sample-theta, echo=FALSE, warning=FALSE}
# Loading the RGM package
suppressPackageStartupMessages(library(rgm))

suppressPackageStartupMessages(library(ggplot2))

suppressPackageStartupMessages(library(pROC))

ps = post_processing_rgm(a,res)

```

```{r rgm_recovery, echo=FALSE, warning=FALSE}
ps$rgm_recovery
```

```{r roc_plot, echo=FALSE, warning=FALSE}
ps$roc_plot
```

```{r estimation_of_alpha, echo=FALSE, warning=FALSE}
ps$estimation_of_alpha
```

```{r posterior_distribution, echo=FALSE, warning=FALSE}
ps$posterior_distribution
```

```{r beta_convergence, echo=FALSE, warning=FALSE}
ps$beta_convergence
```

